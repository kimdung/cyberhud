<!DOCTYPE html>

<!-- Bác tìm kiếm gì ở đây? -->
<!-- Bác tìm kiếm gì ở đây? -->
<!-- Bác tìm kiếm gì ở đây? -->
<!-- Bác tìm kiếm gì ở đây? -->

<html>
<head>
    <title>Tuỳ biến CyberHud</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
     <style>
        body {
            font-family: Arial, sans-serif;
            margin: 10;
            padding: 0;
            background-color: #f0f0f0;
        }
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
    </style>
</head>
<body>
    <div class="topnav">
        <h1>Tuỳ biến CyberHud</h1>
    </div>
    <div class="content">
        <p>
            <button id="connectBleButton" class="connectButton"> Kết nối CyberHud (ấn vào đây) </button>
        </p>
        <p class="gray-label">Trạng thái kết nối: <strong><span id="bleState" style="color:#d13a30;">Không kết nối</span></strong></p>
   
    </div>
    
    <div id="configBlock" style="display: none;">
    <p>
        <p>
            Sửa giá trị trong bảng dưới rồi ấn <b>Gửi</b>
        </p>
        <table>
            <tr>
                <td>Xoay màn hình</td>
                <td>
                    <select id="display_rotation" onchange="updateConfig()">
                        <option value="1">1 (cổng sạc bên phải)</option>
                        <option value="3">3 (cổng sạc bên trái)</option>
                        <option value="5">5 (ảnh ngược, cổng sạc bên phải)</option>
                        <option value="7">7 (ảnh ngược, cổng sạc bên trái)</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Kiểu màn hình</td>
                <td>
                    <select id="screen" onchange="updateConfig()">
                        <option value="0">Biển tốc độ giới hạn ở giữa</option>
                        <option value="1">Tốc độ hiện tại ở giữa</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Upload ảnh màn hình khởi động (1) </td>
                <td>
                    <button id="transfer-file-button">Upload</button>
                    <div id="file-transfer-percent" style="display: none;">0%</div>
                </td>
            </tr>
            <tr>
                <td>Thời gian hiện ảnh màn hình khởi động (2) </td>
                <td>
                    <input type="number" id="boot_screen_duration" min="0" max="255" onchange="updateConfig()">
                </td>
            </tr>

            <tr>
                <td>Độ sáng LED cảnh báo</td>
                <td>
                    <input type="range" id="led_brightness" min="0" max="9" oninput="updateConfig()">
                </td>
            </tr>

            <tr>
                <td>Độ sáng màn hình khi trời tối</td>
                <td>
                    <input type="range" id="night_brightness" min="0" max="9" oninput="updateConfig()">
                </td>
            </tr>

            
            <tr>
                <td>Cảnh báo tốc độ trễ (3) </td>
                <td>
                    <input type="number" id="speed_limit_offset" min="0" onchange="updateConfig()">
                </td>
            </tr>

            <tr>
                <td>Trạng thái màn hình khi không có kết nối </td>
                <td>
                    <select id="sleep_screen_mode" onchange="updateConfig()">
                        <option value="0">0 (Tắt màn hình)</option>
                        <option value="1">1 (Bật dasai mochi)</option>
                        <option value="2">2 (Hiện ảnh)</option>
                    </select>
                </td>
            </tr>

            <tr>
                <td>Hiện biển báo mờ mờ khi không có biển báo </td>
                <td>
                    <select id="show_image_holder" onchange="updateConfig()">
                        <option value="1">Có hiện</option>
                        <option value="0">Không hiện</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Kêu bip khi tốc độ giới hạn thay đổi </td>
                <td>
                    <select id="beep_limit_change" onchange="updateConfig()">
                        <option value="1">1 (Kêu)</option>
                        <option value="0">0 (Ko kêu)</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Thời gian (số giây) giữa các lần bip bip</td>
                <td>
                    <input type="number" id="pause_between_beep" min="1" max="100" oninput="updateConfig()">
                </td>
            </tr>
        </table>
        <p>
            <i>
                1) Ảnh jpeg 320x240, nhở hơn 100KB. CyberHud tự khởi động lại khi up thành công <br>
                2) Thời gian đơn vị giây. Tối đa 255 giây. 0 giây tức là không hiện. <br>
                3) Cảnh báo tốc độ trễ ví dụ tốc độ giới hạn là 50km/h, muốn đi vượt quá 53km/h mới cảnh báo thì nhập 3 <br>
            </i>
        </p>
        <p>          
        </p>
        <table>
            <tr>
                <td>Kết nối đầu đọc obd vgate icar pro 4.0 <br>Chỉ bật khi có đầu đọc</td>
                <td>
                    <select id="obd_scan_duration" onchange="updateConfig()">
                        <option value="0">0 (Tắt)</option>
                        <option value="5">5 (Bật scan 5s)</option>                
                        <option value="10">10 (Bật scan 10s)</option>                
                    </select>
                </td>
            </tr>
          <!--  <tr style="display: none;>
                <td>Tự ngủ sau khi có kết nối (giây) </td>
                <td>
                    <input type="number" id="awake_duration" min="0" onchange="updateConfig()">
                </td>
            </tr>
            <tr style="display: none;>
                <td>Thời gian ngủ (giây) </td>
                <td>
                    <input type="number" id="sleep_duration" min="0" onchange="updateConfig()">
                </td>
            </tr> -->
        </table>    
        
        <p>
            <button id="sendButton" onclick="send()">Gửi</button> <strong><span id="sendState" style="color:#24af37;"></span></strong>
        </p>
        <p>
            <input type="text" size="140"  id="configOutput" readonly style="display: none;">
        </p>
        
    </p>
</div>
</body>

<script>

 const _0x4fdaea=_0xe89d;(function(_0xdb884a,_0x387603){const _0x2ae09b=_0xe89d,_0x555d05=_0xdb884a();while(!![]){try{const _0x1c14b5=-parseInt(_0x2ae09b(0x98))/0x1*(-parseInt(_0x2ae09b(0xba))/0x2)+-parseInt(_0x2ae09b(0xc4))/0x3*(-parseInt(_0x2ae09b(0xb1))/0x4)+-parseInt(_0x2ae09b(0xae))/0x5+-parseInt(_0x2ae09b(0xdc))/0x6+-parseInt(_0x2ae09b(0xc7))/0x7+-parseInt(_0x2ae09b(0xc3))/0x8*(parseInt(_0x2ae09b(0x84))/0x9)+parseInt(_0x2ae09b(0xe8))/0xa*(parseInt(_0x2ae09b(0x82))/0xb);if(_0x1c14b5===_0x387603)break;else _0x555d05['push'](_0x555d05['shift']());}catch(_0x53a36a){_0x555d05['push'](_0x555d05['shift']());}}}(_0x129e,0xb4e8c));const connectButton=document[_0x4fdaea(0x81)](_0x4fdaea(0xbf)),transferFileButton=document[_0x4fdaea(0x81)]('transfer-file-button'),bleStateContainer=document[_0x4fdaea(0x81)](_0x4fdaea(0xe3)),percent=document['getElementById'](_0x4fdaea(0xaf)),sendButton=document[_0x4fdaea(0x81)]('sendButton'),brightnessSlider=document[_0x4fdaea(0x81)](_0x4fdaea(0xac)),brightnessValue=document[_0x4fdaea(0x81)]('brightness_value'),configBlock=document[_0x4fdaea(0x81)](_0x4fdaea(0xe2)),configOutput=document[_0x4fdaea(0x81)](_0x4fdaea(0x8f)),DEVICE_NAME=_0x4fdaea(0x87),SERVICE_UUID='0000fff0-0000-1000-8000-00805f9b34fb',WRITE_CHAR_UUID='0000fff2-0000-1000-8000-00805f9b34fb',NOTIF_CHAR_UUID=_0x4fdaea(0xbb),FILE_BLOCK_UUID='0000fff3-0000-1000-8000-00805f9b34fb',DEVICE_INFO_SERVICE_UUID='0000180a-0000-1000-8000-00805f9b34fb',FIRMWARE_CHARACTERISTIC_UUID=_0x4fdaea(0xa2);function _0x129e(){const _0x3a6fc5=['screen','Disconnect\x20Device.','byteLength','Trình\x20duyệt\x20này\x20(thiết\x20bị\x20này)\x20không\x20hỗ\x20trợ!<br>\x20','Device\x20Selected:','location',';show_image_holder=1','configOutput','display_rotation',';screen=','night_brightness','onchange','split','log','style','createElement','20446NmGHsO','click','Read\x20value:\x20','beep_limit_change','Chưa\x20kết\x20nối\x20với\x20thiết\x20bị\x20Bluetooth.','innerHTML','BKHN;display_rotation=',';obd_scan_duration=','error','round','00002a26-0000-1000-8000-00805f9b34fb',';boot_screen_duration=0','getPrimaryService','display','\x20bytes\x20but\x20maximum\x20is\x20','gattserverdisconnected','readAsArrayBuffer','Không\x20kết\x20nối',';led_brightness=','disconnect','led_brightness','requestDevice','855125meUuOW','file-transfer-percent','decode','20clbWnV','Device\x20Disconnected','sleep_screen_mode','Đã\x20kết\x20nối\x20với\x20CyberHud\x20',';show_image_holder=','input','readValue','block','file','42FAldaw','0000fff1-0000-1000-8000-00805f9b34fb','from',';pause_between_beep=',';boot_screen_duration=','connectBleButton','target','\x20value\x20=\x20','bluetooth','2148344flYtNR','87981jyKCnK',';night_brightness=','#d13a30','1503404GjaUzY','connected',';screen=1','Current\x20config\x20value:\x20',';obd_scan_duration=0',';sleep_screen_mode=1','alert','File\x20length\x20is\x20too\x20long:\x20','undefined','BKHN','getCharacteristic','boot_screen_duration','connect','charCodeAt',';beep_limit_change=','writeValueWithoutResponse','addEventListener','gatt',';night_brightness=5','replace','Đã\x20gửi!\x20Reload\x20sau\x203s','5728080Faewtx','obd_scan_duration','none','value','Connecting\x20to\x20device\x20...','map','configBlock','bleState','result','accept','files','name','32820sLzWqV','characteristicvaluechanged',';beep_limit_change=0','Initializing\x20Bluetooth...','reload','min','Getting\x20firmware\x20characteristics\x20...','type','forEach','Hoặc\x20thử\x20mở\x20trang\x20này\x20bằng\x20điện\x20thoại\x20Android.\x20<br>','show_image_holder','getElementById','8646DIVHtA','Hoặc\x20thử\x20cài\x20ứng\x20dụng\x20<a\x20href=\x22https://apps.apple.com/us/app/bluefy-web-ble-browser/id1492822055\x22>Bluefy</a>\x20trên\x20iPhone\x20và\x20dùng\x20nó\x20để\x20mở\x20lại\x20trang\x20này.','36hsbVfq','color','Try\x20to\x20read\x20revision\x20value','VIETMAP_HUD'];_0x129e=function(){return _0x3a6fc5;};return _0x129e();}var bleServer,fileBlockCharacteristic,defaultConfig='BKHN;display_rotation=3;show_clock=1;led_brightness=9;speed_limit_offset=0'+_0x4fdaea(0xcb)+_0x4fdaea(0xd9)+';inactive_duration=1'+_0x4fdaea(0x8e)+_0x4fdaea(0xea)+_0x4fdaea(0xcc)+_0x4fdaea(0xc9)+';pause_between_beep=2'+_0x4fdaea(0xa3);!navigator[_0x4fdaea(0xc2)]&&(console[_0x4fdaea(0x95)]('Web\x20Bluetooth\x20API\x20is\x20not\x20available\x20in\x20this\x20browser!'),bleStateContainer[_0x4fdaea(0x9d)]=_0x4fdaea(0x8b)+'Thử\x20mở\x20trang\x20này\x20bằng\x20máy\x20tính\x20và\x20trình\x20duyệt\x20Chrome).<br>'+_0x4fdaea(0xf1)+_0x4fdaea(0x83),connectButton[_0x4fdaea(0x96)][_0x4fdaea(0xa5)]=_0x4fdaea(0xde));connectButton[_0x4fdaea(0xd7)]('click',_0x2490a9=>{const _0x116ddd=_0x4fdaea;connect(),transferFileButton[_0x116ddd(0xd7)](_0x116ddd(0x99),function(_0x104819){const _0x2ccca3=_0x116ddd;let _0x43faa4=document[_0x2ccca3(0x97)](_0x2ccca3(0xb6));_0x43faa4[_0x2ccca3(0xef)]=_0x2ccca3(0xb9),_0x43faa4[_0x2ccca3(0xe5)]='image/jpeg',_0x43faa4[_0x2ccca3(0x93)]=_0x238624=>{const _0x3add54=_0x2ccca3;let _0x483008=Array[_0x3add54(0xbc)](_0x43faa4[_0x3add54(0xe6)]),_0x5b12d3=_0x483008[0x0],_0x2dcd2a=new FileReader();_0x2dcd2a['onload']=function(_0x3b8c85){const _0x4843b9=_0x3add54;let _0x5941e8=_0x3b8c85[_0x4843b9(0xc0)][_0x4843b9(0xe4)],_0x460867=new Uint8Array(_0x5941e8);transferFile(_0x5941e8);},_0x2dcd2a[_0x3add54(0xa8)](_0x5b12d3);},_0x43faa4[_0x2ccca3(0x99)]();});});function onDisconnected(_0xb4e01c){const _0x18e659=_0x4fdaea;bleStateContainer['innerHTML']=_0x18e659(0xa9),bleStateContainer[_0x18e659(0x96)][_0x18e659(0x85)]='#d13a30',configBlock[_0x18e659(0x96)][_0x18e659(0xa5)]=_0x18e659(0xde),connectButton['style'][_0x18e659(0xa5)]=_0x18e659(0xb8);}async function connect(){const _0x4d89c4=_0x4fdaea;console[_0x4d89c4(0x95)](_0x4d89c4(0xeb));const _0x26df12=await navigator[_0x4d89c4(0xc2)][_0x4d89c4(0xad)]({'filters':[{'name':DEVICE_NAME}],'optionalServices':[SERVICE_UUID,DEVICE_INFO_SERVICE_UUID]});_0x26df12[_0x4d89c4(0xd7)](_0x4d89c4(0xa7),onDisconnected),console[_0x4d89c4(0x95)](_0x4d89c4(0x8c),_0x26df12[_0x4d89c4(0xe7)]),bleStateContainer[_0x4d89c4(0x9d)]='Đang\x20kết\x20nối\x20với\x20CyberHud\x20',bleStateContainer[_0x4d89c4(0x96)][_0x4d89c4(0x85)]='#242237',console['log'](_0x4d89c4(0xe0)),bleServer=await _0x26df12[_0x4d89c4(0xd8)][_0x4d89c4(0xd3)](),console[_0x4d89c4(0x95)]('Getting\x20device\x20info\x20service\x20...');const _0x2b1e54=await bleServer['getPrimaryService'](DEVICE_INFO_SERVICE_UUID);console[_0x4d89c4(0x95)](_0x4d89c4(0xee));const _0x34714d=await _0x2b1e54[_0x4d89c4(0xd1)](FIRMWARE_CHARACTERISTIC_UUID);console['log'](_0x4d89c4(0x86));const _0x107b11=await _0x34714d[_0x4d89c4(0xb7)]();console['log'](_0x4d89c4(0x9a),_0x107b11);const _0x2c5fbf=new TextDecoder()[_0x4d89c4(0xb0)](_0x107b11);bleStateContainer['style']['color']='#24af37',bleStateContainer[_0x4d89c4(0x9d)]=_0x4d89c4(0xb4)+_0x2c5fbf,configBlock['style'][_0x4d89c4(0xa5)]=_0x4d89c4(0xb8),console['log']('Decoded\x20value:\x20',_0x2c5fbf),parseData(),loadCurrentConfig(),connectButton[_0x4d89c4(0x96)][_0x4d89c4(0xa5)]=_0x4d89c4(0xde);}async function loadCurrentConfig(){const _0x24dff3=_0x4fdaea,_0x469b0c=await bleServer[_0x24dff3(0xa4)](SERVICE_UUID),_0x59c4b7=await _0x469b0c['getCharacteristic'](NOTIF_CHAR_UUID);_0x59c4b7['addEventListener'](_0x24dff3(0xe9),handleCharacteristicChange),_0x59c4b7['startNotifications'](),fileBlockCharacteristic=await _0x469b0c[_0x24dff3(0xd1)](FILE_BLOCK_UUID);const _0x4baa8c=await _0x469b0c[_0x24dff3(0xd1)](WRITE_CHAR_UUID),_0x5c401b='LOAD',_0x1965df=Uint8Array['from'](_0x5c401b[_0x24dff3(0x94)]('')[_0x24dff3(0xe1)](_0x9f57a4=>_0x9f57a4['charCodeAt']()));_0x4baa8c['writeValueWithoutResponse'](_0x1965df);}function handleCharacteristicChange(_0x345659){const _0x1aeb3f=_0x4fdaea,_0x52233b=new TextDecoder()[_0x1aeb3f(0xb0)](_0x345659[_0x1aeb3f(0xc0)][_0x1aeb3f(0xdf)]);console[_0x1aeb3f(0x95)](_0x1aeb3f(0xca),_0x52233b),_0x52233b!=''&&(defaultConfig=_0x52233b,parseData());}function _0xe89d(_0x4cb7c2,_0x55942b){const _0x129ed7=_0x129e();return _0xe89d=function(_0xe89d3d,_0x10f1fb){_0xe89d3d=_0xe89d3d-0x80;let _0x591279=_0x129ed7[_0xe89d3d];return _0x591279;},_0xe89d(_0x4cb7c2,_0x55942b);}async function send(){const _0x26a45a=_0x4fdaea,_0x667ed1=await bleServer[_0x26a45a(0xa4)](SERVICE_UUID),_0x409a96=await _0x667ed1[_0x26a45a(0xd1)](WRITE_CHAR_UUID),_0x2aa4d5=document['getElementById'](_0x26a45a(0x8f))[_0x26a45a(0xdf)],_0x58c558=Uint8Array['from'](_0x2aa4d5[_0x26a45a(0x94)]('')['map'](_0x778e95=>_0x778e95[_0x26a45a(0xd4)]()));await _0x409a96[_0x26a45a(0xd6)](_0x58c558),sendState['innerHTML']=_0x26a45a(0xdb),setTimeout(()=>window[_0x26a45a(0x8d)][_0x26a45a(0xec)](),0xbb8);}function disconnectDevice(){const _0x1ebeff=_0x4fdaea;console[_0x1ebeff(0x95)](_0x1ebeff(0x89)),bleServer&&bleServer[_0x1ebeff(0xc8)]?(bleServer[_0x1ebeff(0xab)](),console[_0x1ebeff(0x95)](_0x1ebeff(0xb2)),bleStateContainer[_0x1ebeff(0x9d)]='Không\x20kết\x20nối',bleStateContainer[_0x1ebeff(0x96)][_0x1ebeff(0x85)]=_0x1ebeff(0xc6),configBlock[_0x1ebeff(0x96)][_0x1ebeff(0xa5)]=_0x1ebeff(0xde)):(console[_0x1ebeff(0xa0)]('Bluetooth\x20is\x20not\x20connected.'),window[_0x1ebeff(0xcd)](_0x1ebeff(0x9c)));}function updateConfig(){const _0x2dbd42=_0x4fdaea;var _0x2401cc=_0x2dbd42(0x9e)+document[_0x2dbd42(0x81)](_0x2dbd42(0x90))[_0x2dbd42(0xdf)]+_0x2dbd42(0xaa)+document['getElementById'](_0x2dbd42(0xac))['value']+';speed_limit_offset='+document[_0x2dbd42(0x81)]('speed_limit_offset')['value']+_0x2dbd42(0xc5)+document[_0x2dbd42(0x81)](_0x2dbd42(0x92))[_0x2dbd42(0xdf)]+_0x2dbd42(0x9f)+document[_0x2dbd42(0x81)](_0x2dbd42(0xdd))[_0x2dbd42(0xdf)]+_0x2dbd42(0xb5)+document[_0x2dbd42(0x81)](_0x2dbd42(0x80))[_0x2dbd42(0xdf)]+_0x2dbd42(0xd5)+document[_0x2dbd42(0x81)](_0x2dbd42(0x9b))[_0x2dbd42(0xdf)]+';sleep_screen_mode='+document['getElementById'](_0x2dbd42(0xb3))[_0x2dbd42(0xdf)]+_0x2dbd42(0x91)+document['getElementById'](_0x2dbd42(0x88))['value']+_0x2dbd42(0xbd)+document['getElementById']('pause_between_beep')['value']+_0x2dbd42(0xbe)+document[_0x2dbd42(0x81)](_0x2dbd42(0xd2))['value'];configOutput[_0x2dbd42(0xdf)]=_0x2401cc;}function parseData(){const _0x3b8943=_0x4fdaea;configOutput[_0x3b8943(0xdf)]=defaultConfig;var _0x4a041f=configOutput[_0x3b8943(0xdf)];_0x4a041f[_0x3b8943(0x94)](';')[_0x3b8943(0xf0)](function(_0x498ccd){const _0x3b6d91=_0x3b8943;var _0x6b6d51=_0x498ccd['split']('=');console[_0x3b6d91(0x95)]('key\x20=\x20'+_0x6b6d51[0x0]+_0x3b6d91(0xc1)+_0x6b6d51[0x1]);var _0x50cfb8=document['getElementById'](_0x6b6d51[0x0]);typeof _0x50cfb8!=_0x3b6d91(0xcf)&&_0x50cfb8!=null&&(_0x6b6d51[0x0]=='led_color'?_0x50cfb8['value']=_0x6b6d51[0x1][_0x3b6d91(0xda)]('0x','#'):_0x50cfb8['value']=_0x6b6d51[0x1]);});}async function transferFile(_0x517249){const _0x527b93=_0x4fdaea;let _0x5aa3e9=0x64*0x400;if(_0x517249[_0x527b93(0x8a)]>_0x5aa3e9){console['error'](_0x527b93(0xce)+_0x517249[_0x527b93(0x8a)]+_0x527b93(0xa6)+_0x5aa3e9);return;}transferFileButton['style']['display']=_0x527b93(0xde),sendButton[_0x527b93(0x96)][_0x527b93(0xa5)]=_0x527b93(0xde),percent[_0x527b93(0x96)][_0x527b93(0xa5)]=_0x527b93(0xb8),sendFileBlock(_0x517249,0x0);}const delay=_0x457d5b=>{return new Promise(_0x490432=>setTimeout(_0x490432,_0x457d5b));};async function sendFileBlock(_0x1b1751,_0x475df1){const _0x2daa5e=_0x4fdaea;await delay(0x64);let _0x3e9a90=_0x1b1751['byteLength']-_0x475df1;const _0x29b73b=0x80,_0xcef635=Math[_0x2daa5e(0xed)](_0x3e9a90,_0x29b73b),_0x3d3c76=new Uint8Array(_0x1b1751,_0x475df1,_0xcef635);await fileBlockCharacteristic['writeValue'](_0x3d3c76),_0x3e9a90-=_0xcef635;_0x3e9a90>0x0&&(percent[_0x2daa5e(0x9d)]=Math[_0x2daa5e(0xa1)](0x64*(_0x475df1/_0x1b1751[_0x2daa5e(0x8a)]))+'%',_0x475df1+=_0xcef635,sendFileBlock(_0x1b1751,_0x475df1));if(_0x3e9a90<=0x0){transferFileButton[_0x2daa5e(0x96)][_0x2daa5e(0xa5)]=_0x2daa5e(0xb8),sendButton['style']['display']=_0x2daa5e(0xb8),percent[_0x2daa5e(0x96)]['display']=_0x2daa5e(0xde);const _0x2309a3=_0x2daa5e(0xd0),_0x3c13c3=Uint8Array[_0x2daa5e(0xbc)](_0x2309a3[_0x2daa5e(0x94)]('')[_0x2daa5e(0xe1)](_0x9698bd=>_0x9698bd[_0x2daa5e(0xd4)]()));fileBlockCharacteristic['writeValueWithoutResponse'](_0x3c13c3);}}
</script>

</html>
